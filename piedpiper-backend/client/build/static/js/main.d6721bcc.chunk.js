(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,a){e.exports={Profile:"Profile_Profile__1xHMh",Open:"Profile_Open__1YvNg",Close:"Profile_Close__1dveZ",ProfileImage:"Profile_ProfileImage__2411c",ProfileImageContainer:"Profile_ProfileImageContainer__1ttkN",ChangeImage:"Profile_ChangeImage__e6Ga3",CameraIcon:"Profile_CameraIcon___Jzfr",ChangeImageText:"Profile_ChangeImageText__3BiBU",ProfileInfo:"Profile_ProfileInfo__3OSgb",Names:"Profile_Names__3E-ed",Label:"Profile_Label__3IKvg",Name:"Profile_Name__1NsMB",Username:"Profile_Username__1Y28R",About:"Profile_About__2USg6",SocialProfiles:"Profile_SocialProfiles__2eZXK",SocialIcons:"Profile_SocialIcons__k8nt0"}},14:function(e,t,a){e.exports={Contact:"Contact_Contact__I6ygz",ContactDetails:"Contact_ContactDetails__1Njgv",Active:"Contact_Active__1q391",ImageContainer:"Contact_ImageContainer__15hN_",FloatedRight:"Contact_FloatedRight__267zm",FloatedLeft:"Contact_FloatedLeft__2-Piy",LastMessage:"Contact_LastMessage__3rS-w",UnreadMessagesContainer:"Contact_UnreadMessagesContainer__1XUCU",LastUpdated:"Contact_LastUpdated__2lx4g",UnreadMessages:"Contact_UnreadMessages__3nsN4"}},148:function(e,t){},16:function(e,t,a){e.exports={ChatScreen:"ChatScreen_ChatScreen__3NJNg",ContactsPane:"ChatScreen_ContactsPane__2wBCJ",MenuBar:"ChatScreen_MenuBar__xjjtB",MenuImageContainer:"ChatScreen_MenuImageContainer__2Zzey",BackgroundImage:"ChatScreen_BackgroundImage__3BN8F",Chat:"ChatScreen_Chat__9S2DJ",Msgs:"ChatScreen_Msgs__20qJ1"}},173:function(e,t,a){},175:function(e,t,a){"use strict";a.r(t);var n,o,r=a(0),c=a.n(r),l=a(75),i=a.n(l),s=(a(95),a(4)),u=a(5),m=a(7),p=a(6),d=a(8),h=a(183),f=a(179),g=a(180),_=a(182),v=a(3),E=a(50),C=a.n(E),b=function(e){return c.a.createElement("button",{onClick:e.clicked,disabled:e.disabled,className:[C.a.Button,C.a[e.btnType]].join(" ")},e.children)},O=a(51),w=a.n(O),S=function(e){return c.a.createElement("div",{className:w.a.IncomingCall},c.a.createElement("span",null,"Incoming ",e.callType," call from ",e.caller),c.a.createElement("span",{className:w.a.Buttons},c.a.createElement(b,{clicked:e.acceptCall,btnType:"Success"},"Accept"),c.a.createElement(b,{clicked:e.rejectCall,btnType:"Danger"},"Reject")))},N=a(2),y=a(15),I=a(52),j=a.n(I),k=a(77),T=a.n(k).a.create({baseURL:"https://piedpiperchat.herokuapp.com/"}),R=function(e){return function(t){setTimeout(function(){localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("expiresIn"),t(P())},1e3*e)}},L=function(e){return{type:"LOG_IN_FAILED",error:e}},P=function(){return{type:"LOG_OUT"}},x=function(e,t){return{type:"ON_AUTH",token:e,userId:t}},A=a(78),B=a.n(A),M=a(20),D=a.n(M),U=localStorage.getItem("userId"),F={},G=B()("https://piedpiperchat.herokuapp.com:8082"),V={iceServers:[{url:"stun:stun2.1.google.com:19302"}]},J=null;G.on("connection",function(){console.log("Connected to the signaling server")});G.on("message",function(e){console.log("Got message",e);var t,a,r,c=JSON.parse(e);switch(c.type){case"login":console.log("logged in");break;case"requestToCall":console.log("received a request from "+c.from),z(c.from);break;case"answerToRequest":console.log("received an answer from "+c.from),H(c.from);break;case"offer":a=c.offer,r=c.name,console.log("Accepting offer from "+n),o.setRemoteDescription(new RTCSessionDescription(a)),console.log("Creating and sending answer to "+n),o.createAnswer(function(e){o.setLocalDescription(e),q({type:"answer",answer:e,from:r})},function(e){alert("Error when creating an answer")});break;case"answer":!function(e,t){console.log("Accepting answer from "+t),o.setRemoteDescription(new RTCSessionDescription(e))}(c.answer,c.from);break;case"candidate":t=c.candidate,o.addIceCandidate(new RTCIceCandidate(t));break;case"leave":$()}}),G.onerror=function(e){console.log("Got error",e)};var H=function(e){o.createOffer(function(e){q({type:"offer",offer:e}),o.setLocalDescription(e)},function(e){alert("Error when creating an offer")})},z=function(e){n=e,Wt.dispatch({type:"ON_INCOMING_CALL",callType:"video",caller:e}),(o=new RTCPeerConnection(V)).ontrack=function(e){console.log("got remote stream"),console.log(e),Wt.dispatch(K(e))},console.log(o),o.onicecandidate=function(e){e.candidate&&q({type:"candidate",candidate:e.candidate})},W().then(Y).catch(function(e){return console.log(e)})};function q(e){n&&(e.name=n),G.send(JSON.stringify(e))}var W=function(){return navigator.mediaDevices.getUserMedia({video:{width:1280,height:720,frameRate:15},audio:!0})},X=function(e){return{type:"ON_ERROR",error:e}},Y=function(e){Wt.dispatch({type:"CALL_INIT"}),q({type:"requestToCall",from:U,to:n}),J=e,Wt.dispatch(Z(e)),e.getTracks().forEach(function(t){console.log(t),o.addTrack(t,e)})},K=function(e){return{type:"ON_TRACK",remoteStream:e.streams[0]}},Z=function(e){return{type:"ON_LOCAL_STREAM",stream:e}};var Q=function(){return{type:"END_CALL"}};function $(){n=null,J.getTracks().forEach(function(e){return e.stop()}),Wt.dispatch(Q()),o.close(),o.onicecandidate=null,o.onaddTrack=null}var ee,te=a(53),ae=function(){return function(e){e({type:"ON_ROOMS_FETCHED",contacts:ee.rooms.map(function(e){var t={},a=e.isPrivate?e.name.split("and").filter(function(e){return e!==ee.id}).join(""):e.name;return a.length?t.name=a:t.name=ee.id,t.id=e.id,Object(N.a)({},e,t)})})}},ne=function(e){return{type:"CHAT_INIT_SUCCESS",currentUser:e}},oe=function(e){return function(t,a){var n=e.rooms;t(ae()),n.map(function(n){return e.subscribeToRoom({roomId:n.id,hooks:{onMessage:function(e){var n=!1,o=a().chat.currentRoom;o&&o.id===e.roomId&&(n=!0),t(function(e,t){return{type:"ON_NEW_MESSAGE",message:e,belongsToCurrentRoom:t}}(e,n))}},messageLimit:0})})}},re=function(e){return function(t){ee.fetchMessages({roomId:e.id,direction:"older",limit:100}).then(function(a){t(function(e,t){return{type:"FETCH_MESSAGES_SUCCESS",messages:e,room:t}}(a,e))}).catch(function(e){console.log("Error fetching messages: ".concat(e))})}},ce=function(e){return function(t){var a=localStorage.getItem("token");T.get("/search/".concat(e.chatParticipant),{headers:{"x-auth-token":a}}).then(function(a){ee.createRoom({name:"".concat(ee.id,"and").concat(e.chatParticipant),private:!0,addUserIds:[e.chatParticipant],customData:{displayImage:a.data.avatar}}).then(function(e){console.log(e),t({type:"START_NEW_CHAT_SUCCESS"}),t(oe(ee))}).catch(function(e){console.log(e),t(function(e){return{type:"START_NEW_CHAT_FAILED",err:e}}(e))})}).catch(function(e){return console.log(e)})}},le=a(28),ie=a.n(le),se=function(e){var t=null,a=[ie.a.InputElement];switch(e.invalid&&e.shouldValidate&&e.touched&&a.push(ie.a.Invalid),e.elementType){case"input":t=c.a.createElement("input",Object.assign({className:a.join(" ")},e.elementConfig,{value:e.value,name:e.name,onChange:e.changed}));break;case"textarea":t=c.a.createElement("textarea",Object.assign({className:a.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"select":t=c.a.createElement("select",{className:a.join(" "),value:e.value,onChange:e.changed},e.elementConfig.options.map(function(e){return c.a.createElement("option",{key:e.value,value:e.value},e.displayValue)}));break;default:t=c.a.createElement("input",Object.assign({className:ie.a.InputElement},e.elementConfig,{value:e.value,onChange:e.changed}))}return c.a.createElement("div",{className:ie.a.Input},c.a.createElement("label",{className:ie.a.Label},e.label),t)},ue=function(e,t){return Object(N.a)({},e,t)},me=function(e,t){var a=!0;if(!t)return!0;if(t.required&&(a=""!==e.trim()&&a),t.minLength&&(a=e.length>=t.minLength&&a),t.maxLength&&(a=e.length<=t.maxLength&&a),t.isEmail){a=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)&&a}if(t.isNumeric){a=/^\d+$/.test(e)&&a}return a},pe=function(e,t,a,n){switch(e){case"video":return c.a.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 20",width:n,height:a},c.a.createElement("path",{fill:t,fillOpacity:".4",d:"M15.243 5.868l-3.48 3.091v-2.27c0-.657-.532-1.189-1.189-1.189H1.945c-.657 0-1.189.532-1.189 1.189v7.138c0 .657.532 1.189 1.189 1.189h8.629c.657 0 1.189-.532 1.189-1.189v-2.299l3.48 3.09v-8.75z"}));case"voice":return c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -256 1792 1792",id:"svg3013",version:"1.1",width:n,height:a},c.a.createElement("path",{transform:"matrix(1,0,0,-1,159.45763,1293.0169)",d:"m 1408,296 q 0,-27 -10,-70.5 Q 1388,182 1377,157 1356,107 1255,51 1161,0 1069,0 1042,0 1016.5,3.5 991,7 959,16 927,25 911.5,30.5 896,36 856,51 816,66 807,69 709,104 632,152 504,231 367.5,367.5 231,504 152,632 104,709 69,807 66,816 51,856 36,896 30.5,911.5 25,927 16,959 7,991 3.5,1016.5 0,1042 0,1069 q 0,92 51,186 56,101 106,122 25,11 68.5,21 43.5,10 70.5,10 14,0 21,-3 18,-6 53,-76 11,-19 30,-54 19,-35 35,-63.5 16,-28.5 31,-53.5 3,-4 17.5,-25 14.5,-21 21.5,-35.5 7,-14.5 7,-28.5 0,-20 -28.5,-50 -28.5,-30 -62,-55 -33.5,-25 -62,-53 -28.5,-28 -28.5,-46 0,-9 5,-22.5 5,-13.5 8.5,-20.5 3.5,-7 14,-24 10.5,-17 11.5,-19 76,-137 174,-235 98,-98 235,-174 2,-1 19,-11.5 17,-10.5 24,-14 7,-3.5 20.5,-8.5 13.5,-5 22.5,-5 18,0 46,28.5 28,28.5 53,62 25,33.5 55,62 30,28.5 50,28.5 14,0 28.5,-7 14.5,-7 35.5,-21.5 21,-14.5 25,-17.5 25,-15 53.5,-31 28.5,-16 63.5,-35 35,-19 54,-30 70,-35 76,-53 3,-7 3,-21 z",id:"path3017",fill:t,fillOpacity:".4"}));case"ellipsis":return c.a.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:n,height:a},c.a.createElement("path",{fill:t,fillOpacity:".6",d:"M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"}));case"endCall":return c.a.createElement("svg",{version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:n,height:a,viewBox:"0 0 612 612"},c.a.createElement("path",{d:"M306,243.525c-40.8,0-79.05,7.65-117.3,17.85v79.05c0,10.199-5.1,17.85-15.3,22.949c-25.5,12.75-48.45,28.051-68.85,48.45 c-5.1,5.101-10.2,7.65-17.85,7.65c-7.65,0-12.75-2.55-17.85-7.65L5.1,348.075c-2.55-5.1-5.1-10.2-5.1-17.85 c0-7.65,2.55-12.75,7.65-17.851c76.5-73.95,183.6-119.85,298.35-119.85s221.85,45.9,298.35,119.85 c5.101,5.101,7.65,10.2,7.65,17.851c0,7.649-2.55,12.75-7.65,17.85l-63.75,63.75c-5.1,5.101-10.199,7.65-17.85,7.65 s-12.75-2.55-17.85-7.65c-20.4-17.85-43.351-35.7-68.851-48.45c-7.649-5.1-15.3-12.75-15.3-22.949v-79.05 C385.05,251.175,346.8,243.525,306,243.525z",fill:t}));case"microphone":return c.a.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 20",width:n,height:a},c.a.createElement("path",{fill:t,d:"M6 11.745a2 2 0 0 0  2-2V4.941a2 2 0 0 0-4 0v4.803a2 2 0 0 0 2  2.001zm3.495-2.001c0 1.927-1.568 3.495-3.495  3.495s-3.495-1.568-3.495-3.495H1.11c0 2.458  1.828 4.477 4.192 4.819v2.495h1.395v-2.495c2.364-.342 4.193-2.362  4.193-4.82H9.495v.001z"}));default:return}},de=a(79),he=a.n(de),fe=function(e){var t="";if(e.error){var a=e.error.response.data;a.password?t=a.password:a.password2?t=a.password2:a.name?t=e.name:a.authError?t=a.authError:a.username&&(t=a.username)}else t=e.message;return c.a.createElement("div",{className:he.a.ErrorBox},t)},ge=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={controls:{name:{elementType:"input",elementConfig:{placeholder:"Enter your full name",type:"text"},value:"",validation:{required:!0},valid:!1,touched:!1},email:{elementType:"input",elementConfig:{placeholder:"Enter your email",type:"email"},value:"",validation:{required:!0,isEmail:!0},valid:!1,touched:!1},username:{elementType:"input",elementConfig:{placeholder:"Enter username",type:"text"},value:"",validation:{required:!0},valid:!1,touched:!1},password:{elementType:"input",elementConfig:{placeholder:"Enter your password",type:"password"},value:"",validation:{required:!0,minLength:8},valid:!1,touched:!1},password2:{elementType:"input",elementConfig:{placeholder:"Confirm your password",type:"password"},value:"",validation:{required:!0,minLength:8,isEqual:!1},valid:!1,touched:!1}},formIsValid:!1,loading:!1},a.onChange=function(e,t){var n=e.target.value,o=ue(a.state.controls[t],{value:n,touched:!0,valid:me(n,a.state.controls[t].validation)}),r=ue(a.state.controls,Object(y.a)({},t,o)),c=!0;for(var l in r)c=r[l].valid&&c;a.setState({controls:r,formIsValid:c})},a.onSubmit=function(e){a.setState({loading:!0}),e.preventDefault();var t=a.state.controls,n=t.password,o=t.password2;console.log(n.value,o.value);var r=Object(N.a)({},a.state.controls),c={};for(var l in r)c[l]=r[l].value;a.props.onRegister(c)},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.state.loading,t=this.props,a=t.error,n=t.registrationSuccess,o=t.history;n?o.push("/login"):a&&e&&this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.controls,o=t.formIsValid,r=this.props.error,l=[];for(var i in n)l.push({id:i,config:n[i]});var s=l.map(function(t){return c.a.createElement(se,{key:t.id,elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,invalid:!t.config.valid,shouldValidate:t.config.validation,touched:t.config.touched,changed:function(a){return e.onChange(a,t.id)}})});return c.a.createElement("div",{className:j.a.RegisterBox},c.a.createElement("h2",null," Register "),r&&c.a.createElement(fe,{error:r}),c.a.createElement("form",{onSubmit:this.onSubmit},s,c.a.createElement("p",{onClick:function(){return e.props.history.push("/login")}},"Already signed up?"),c.a.createElement(b,{btnType:"Success",disabled:!o},a?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:j.a.LoadingText},"Joining..."),c.a.createElement("i",{className:"fas fa-spinner fa-spin"})):c.a.createElement(c.a.Fragment,null,"Join Now"))))}}]),t}(r.Component),_e=Object(v.b)(function(e){return{registrationSuccess:e.auth.registrationSuccess,error:e.auth.error}},function(e){return{onRegister:function(t){return e(function(e){return function(t){t({type:"ON_AUTH_INIT"}),T.post("/register",e).then(function(e){var a=e.data,n=a.userId,o=a.token,r=a.expiresIn;t({type:"ON_REGISTER"}),t(x(o,n)),t(R(r))}).catch(function(e){t(function(e){return{type:"ON_REGISTRATION_FAILED",error:e}}(e))})}}(t))}}})(ge),ve=a(176),Ee=a(29),Ce=a.n(Ee),be=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={controls:{email:{elementType:"input",elementConfig:{placeholder:"Enter your email",type:"email"},value:"",validation:{required:!0,isEmail:!0},valid:!1,touched:!1},password:{elementType:"input",elementConfig:{placeholder:"Enter your password",type:"password"},value:"",validation:{required:!0,minLength:8},valid:!1,touched:!1}},formIsValid:!1,loading:!1},a.onChange=function(e,t){var n=e.target.value,o=ue(a.state.controls[t],{value:n,touched:!0,valid:me(n,a.state.controls[t].validation)}),r=ue(a.state.controls,Object(y.a)({},t,o)),c=!0;for(var l in r)c=r[l].valid&&c;a.setState({controls:r,formIsValid:c})},a.onSubmit=function(e){var t=a.props.onLogIn;a.setState({loading:!0}),e.preventDefault();var n=Object(N.a)({},a.state.controls),o={};for(var r in n)o[r]=n[r].value;t(o)},a.comingSoon=function(){D.a.fire({title:"Coming soon",icon:"info",showCloseButton:!0,focusConfirm:!1,confirmButtonText:'<i class="fa fa-thumbs-up"></i> Great!'})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props.error,t=this.state.loading;e&&t&&this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.controls,o=t.formIsValid,r=this.props,l=r.error,i=r.isLoggedIn,s=r.history,u=null;i&&(u=c.a.createElement(ve.a,{to:"/"}));var m=[];for(var p in n)m.push({id:p,config:n[p]});var d=m.sort(function(e,t){return e.id.localeCompare(t.id)}).map(function(t){return c.a.createElement(se,{key:t.id,elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,invalid:!t.config.valid,shouldValidate:t.config.validation,touched:t.config.touched,changed:function(a){return e.onChange(a,t.id)}})});return c.a.createElement("div",{className:Ce.a.Login},u,c.a.createElement("h2",null," Login "),l&&c.a.createElement(fe,{error:l}),c.a.createElement("form",{onSubmit:this.onSubmit},d,c.a.createElement("span",{className:Ce.a.AuthOptions},c.a.createElement("p",{onClick:function(){return s.push("/register")}},"New to PiperChat?"),c.a.createElement("p",null,"Forgot Password?")),c.a.createElement(b,{btnType:"Success",disabled:!o},a?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:Ce.a.LoadingText},"Logging in..."),c.a.createElement("i",{className:"fas fa-spinner fa-spin"})):c.a.createElement(c.a.Fragment,null,"Login"))),c.a.createElement("hr",null),c.a.createElement("div",{className:Ce.a.LoginOptions},c.a.createElement("h3",null,"Login With"),c.a.createElement("span",{className:Ce.a.LoginOptionsIcons},c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-linkedin"})),c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-google"})),c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-facebook"})))))}}]),t}(r.Component),Oe=Object(v.b)(function(e){return{isLoggedIn:null!==e.auth.token,error:e.auth.error}},function(e){return{onLogIn:function(t){return e(function(e){return function(t){t({type:"ON_AUTH_INIT"}),T.post("/login",e).then(function(e){var a=e.data,n=a.userId,o=a.token,r=a.expiresIn,c=new Date((new Date).getTime()+1e3*r);localStorage.setItem("token",o),localStorage.setItem("userId",n),localStorage.setItem("expiresIn",c),t(function(e,t){return{type:"LOG_IN",token:e,userId:t}}(e.data.token,n)),t(R(r))}).catch(function(e){t(L(e))})}}(t))}}})(be),we=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.logout(),this.props.history.push("/")}},{key:"render",value:function(){return c.a.createElement("div",null)}}]),t}(r.Component),Se=Object(v.b)(null,function(e){return{logout:function(){return e(function(e){localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("expiresIn"),e(P())})}}})(we),Ne=a(178),ye=a(18),Ie=a.n(ye),je=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.isLoggedIn,t=c.a.createElement("ul",null,c.a.createElement("div",null,c.a.createElement("li",null,c.a.createElement(Ne.a,{to:"/"},c.a.createElement("div",{className:Ie.a.Brand},"PiperChat")))),c.a.createElement("div",{className:Ie.a.FloatedRight},c.a.createElement("li",null,c.a.createElement(Ne.a,{to:"/login"},c.a.createElement("div",{className:Ie.a.NavItem},"Login"))),c.a.createElement("li",null,c.a.createElement(Ne.a,{to:"/register"},c.a.createElement("div",{className:Ie.a.NavItem},"Join Now")))));return e&&(t=c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(Ne.a,{to:"/"},c.a.createElement("div",{className:Ie.a.Brand},"PiperChat"))),c.a.createElement("li",null,c.a.createElement(Ne.a,{to:"/logout"},c.a.createElement("div",{className:Ie.a.NavItem},"Logout"))))),c.a.createElement("div",{className:Ie.a.Navbar,style:e?{display:"none"}:null},t)}}]),t}(r.Component),ke=Object(v.b)(function(e){return{isLoggedIn:null!==e.auth.token}})(je),Te=a(27),Re=a(54),Le=a.n(Re),Pe=a(14),xe=a.n(Pe),Ae=a(26),Be=a.n(Ae),Me=a(80),De=a.n(Me),Ue=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={options:a.props.options||[]},a.hideOptions=function(e){a.optionsRef&&!a.optionsRef.contains(e.target)&&a.props.hideOptions()},a.optionClicked=function(e,t){switch(t.name){case"Archive chat":alert("Archive chat");break;case"Mute":alert("Mute");break;case"Exit group":case"Delete chat":a.props.deleteChat(a.props.roomId);break;case"Log out":a.props.history.push("/logout");break;case"Profile":a.props.showProfile(),a.props.hideOptions()}},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideOptions),window.onresize=this.props.hideOptions}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideOptions)}},{key:"render",value:function(){var e=this,t=null;return this.props.show&&(t=c.a.createElement("ul",{ref:function(t){return e.optionsRef=t},className:De.a.OptionsDropbar,style:{top:this.props.position.y+"px",left:this.props.position.x-155+"px"}},this.state.options.map(function(t,a){return c.a.createElement("li",{key:t.name,onClick:function(a){return e.optionClicked(a,t)}},t.name)}))),t}}]),t}(r.Component),Fe=Object(_.a)(Object(v.b)(null,function(e){return{deleteChat:function(t){return e(function(e){return function(t){console.log(typeof e),ee.leaveRoom({roomId:e}).then(function(){console.log("Deleted room with ID: ".concat(e))}).catch(function(t){console.log("Error deleted room ".concat(e,": ").concat(t))})}}(t))}}})(Ue)),Ge=Object(v.b)(function(e){return{userId:e.auth.userId}})(function(e){var t=Object(r.useState)(!1),a=Object(Te.a)(t,2),n=a[0],o=a[1],l=Object(r.useState)({}),i=Object(Te.a)(l,2),s=i[0],u=i[1],m=[xe.a.Contact],p="";e.Active&&m.push(xe.a.Active),e.unopenedMessages[e.id]&&(p=e.unopenedMessages[e.id].length);var d,h=null;return e.room&&(h=c.a.createElement("div",{className:m.join(" "),onClick:e.clicked},c.a.createElement("span",{className:xe.a.ImageContainter},c.a.createElement("img",{src:Be.a,alt:""})),c.a.createElement("div",{className:xe.a.ContactDetails},c.a.createElement("div",{className:xe.a.FloatedLeft},c.a.createElement("span",null,e.room.name),c.a.createElement("span",{className:xe.a.LastMessage},"Honey: Love you too babe.")),c.a.createElement("div",{className:xe.a.FloatedRight},c.a.createElement("span",{className:xe.a.LastUpdated},(d=e.room.updatedAt,Le.a.updateLocale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"LT",nextDay:"[Tomorrow at] LT",lastWeek:"dddd",nextWeek:"dddd [at] LT",sameElse:"L"}}),Le()(d).calendar())),c.a.createElement("div",{className:xe.a.UnreadMessagesContainer},c.a.createElement("span",{className:xe.a.UnreadMessages},p||8),c.a.createElement("i",{onClick:function(e){e.stopPropagation();var t={};t.x=e.clientX+155,t.y=e.clientY,o(!0),u(t)},className:"fa fa-angle-down"}),n&&c.a.createElement(Fe,{position:s,roomId:e.room.id,show:n,hideOptions:function(){o(!1),u({})},options:[{name:"Archive chat"},{name:"Mute"},{name:e.room.isPrivate?"Delete chat":"Exit group"},{name:"Pin chat"},{name:"Mark as unread"}]})))))),h}),Ve=a(22),Je=a.n(Ve),He=a(32),ze=a.n(He),qe=a(82),We=a.n(qe),Xe=(Object(v.b)(null,function(e){return{joinRoom:function(t){return e((a=t,function(e){ee.joinRoom({roomId:a}).then(function(e){console.log("Joined room with ID: ".concat(e.id))}).catch(function(e){console.log("Error joining room ".concat(a,": ").concat(e))})}));var a}}})(function(e){return c.a.createElement("span",{onClick:e.joinRoom(e.id),className:We.a.JoinableRoom},c.a.createElement("img",{src:e.groupImage,alt:""}),c.a.createElement("span",null,c.a.createElement("p",null,e.name),c.a.createElement("p",null,e.lastMessage)))}),a(83)),Ye=a.n(Xe),Ke=function(e){var t=e.goBack,a=e.tabName;return c.a.createElement("div",{className:Ye.a.TabBar},c.a.createElement("i",{className:"fa fa-arrow-left",onClick:t}),c.a.createElement("span",null,a))},Ze=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={showCreateForm:!1,showNewChatForm:!1,groupName:"",participants:[],potentialParticipants:[],newGroupChatParticipants:{},privateChatParticipant:"",joinableRooms:[],ShowJoinableRoomsList:!1,touched:!1,isValid:!1},a.createNewGroupHandler=function(){var e=a.props.user.rooms.filter(function(e){return e.isPrivate&&e.name!==a.props.userId}),t={};e.forEach(function(e){return t[e.name]=!1}),a.setState(function(a){return{showCreateForm:!a.showCreateForm,potentialParticipants:e,ShowJoinableRoomsList:!1,showNewChatForm:!1,newGroupChatParticipants:t}})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.onCreateNewGroup=function(e){e.preventDefault();var t=Object(N.a)({},a.state.newGroupChatParticipants),n=Object.keys(t).filter(function(e){return t[e]});a.props.onCreateNewGroup({participants:n,name:a.state.groupName}),a.setState({groupName:"",newGroupChatParticipants:{}})},a.startNewChatHandler=function(){a.setState(function(e){return{showNewChatForm:!e.showNewChatForm,ShowJoinableRoomsList:!1,showCreateForm:!1}})},a.onStartNewChat=function(e){e.preventDefault();var t={chatParticipant:a.state.privateChatParticipant};a.props.onStartNewChat(t)},a.joinGroup=function(){a.props.user.getJoinableRooms().then(function(e){a.setState(function(t){return{joinableRooms:e,ShowJoinableRoomsList:!t.ShowJoinableRoomsList,showCreateForm:!1,showNewChatForm:!1}})}).catch(function(e){console.log("Error getting joinable rooms: ".concat(e))})},a.onPPChange=function(e){var t=e.target,n=t.name,o=t.checked,r=Object(N.a)({},a.state.newGroupChatParticipants);r[n]=o,a.setState({newGroupChatParticipants:r})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=[ze.a.SideDrawer,ze.a.Close];return this.props.show&&(e=[ze.a.SideDrawer,ze.a.Open]),c.a.createElement("div",{className:e.join(" ")},c.a.createElement(Ke,{goBack:this.props.hideSideDrawer,tabName:this.props.actionType}))}}]),t}(r.Component),Qe=Object(v.b)(function(e){return{token:e.auth.token,userId:e.auth.userId}},function(e){return{onCreateNewGroup:function(t){return e(function(e){return function(t){ee.createRoom({name:e.name,private:!1,addUserIds:e.participants,customData:{foo:42}}).then(function(e){console.log("Created room called ".concat(e.name)),t({type:"CREATE_GROUP_SUCCESS"}),t(oe())}).catch(function(e){console.log("Error creating room ".concat(e)),t(function(e){return{type:"CREATE_GROUP_FAILED",err:e}}(e))})}}(t))},onStartNewChat:function(t){return e(ce(t))}}})(Ze),$e=function(e){var t=Object(r.useState)(!1),a=Object(Te.a)(t,2),n=a[0],o=a[1],l=Object(r.useState)(""),i=Object(Te.a)(l,2),s=i[0],u=i[1],m=function(e){o(function(e){return!e}),u(e)};return c.a.createElement("div",{className:Je.a.NoContacts},c.a.createElement("span",null,"You have no contacts"),c.a.createElement("div",{className:Je.a.UserActions},c.a.createElement("span",{className:Je.a.UserAction,onClick:function(){return m("Add contact")}},c.a.createElement("span",{className:Je.a.ActionsIcons},c.a.createElement("i",{className:"fas fa-search"})),c.a.createElement("span",null,"Add Contact")),c.a.createElement("span",{className:Je.a.UserAction,onClick:function(){return m("Create a group")}},c.a.createElement("span",{className:Je.a.ActionsIcons},c.a.createElement("i",{className:"fas fa-users"})),c.a.createElement("span",null,"Create a group"))),c.a.createElement(Qe,{show:n,actionType:s,hideSideDrawer:function(){return o(!1)}}))},et=a(33),tt=a.n(et),at=function(e){var t=[tt.a.Chat];return e.byCurrentUser&&(t=[tt.a.ByCurrentUser]),c.a.createElement("div",{className:t.join("")},c.a.createElement("li",null,c.a.createElement("span",{className:tt.a.Sender},e.sender),c.a.createElement("br",null),c.a.createElement("span",{className:tt.a.Text},e.text)))},nt=a(16),ot=a.n(nt),rt=a(11),ct=a.n(rt),lt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={},a.comingSoon=function(){D.a.fire({title:"Coming soon",icon:"info",showCloseButton:!0,focusConfirm:!1,confirmButtonText:'<i class="fa fa-thumbs-up"></i> Great!'})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.hideProfile,t=[ct.a.Profile,ct.a.Close];return this.props.show&&(t=[ct.a.Profile,ct.a.Open]),c.a.createElement("div",{className:t.join(" ")},c.a.createElement(Ke,{goBack:e,tabName:"Profile"}),c.a.createElement("div",{className:ct.a.ProfileImageContainer},c.a.createElement("div",{className:ct.a.ProfileImage},c.a.createElement("img",{src:Be.a,alt:""}),c.a.createElement("span",{className:ct.a.ChangeImage},c.a.createElement("span",{className:ct.a.CameraIcon},c.a.createElement("i",{className:"fa fa-camera"})),c.a.createElement("span",{className:ct.a.ChangeImageText},"Change Profile Photo")))),c.a.createElement("div",{className:ct.a.Names},c.a.createElement("span",{className:ct.a.Name},"Abubakar Ibrahim"),c.a.createElement("span",{className:ct.a.Username},"@abkr08")),c.a.createElement("hr",null),c.a.createElement("div",{className:ct.a.About},c.a.createElement("h3",null,"Intro"),c.a.createElement("hr",null),c.a.createElement("span",null,"Write awesome things About Yourself here.")),c.a.createElement("hr",null),c.a.createElement("div",{className:ct.a.SocialProfiles},c.a.createElement("h3",null,"Social Profiles"),c.a.createElement("hr",null),c.a.createElement("div",{className:ct.a.SocialIcons},c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-instagram"})),c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-twitter"})),c.a.createElement("span",{onClick:this.comingSoon},c.a.createElement("i",{className:"fab fa-facebook"})))))}}]),t}(r.Component),it=a(23),st=a.n(it),ut=a(84),mt=a.n(ut),pt=function(e){var t=e.show,a=e.children;return t?c.a.createElement("div",{className:mt.a.Modal},a):null},dt=a(55),ht=a.n(dt),ft=a(85),gt=a(19),_t=a.n(gt),vt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={id:null,room:null,isPlaying:!1},a.endCall=function(){a.setState({room:null}),a.props.endCall(),a.props.role||a.props.closeModal()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;"callee"===this.props.role?this.setState({room:this.props.caller}):(this.props.callUser(this.props.callTo,this.props.callType),this.setState({room:this.props.callTo})),this.props.channel.on("message",function(t){"leave"===JSON.parse(t).type&&(e.props.role||e.props.closeModal())})}},{key:"componentDidUpdate",value:function(){var e=Object(ft.a)(ht.a.mark(function e(){var t,a,n,o,r,c,l;return ht.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.error,n=t.endCall,o=t.closeModal,r=t.callType,c=t.localStream,l=t.remoteStream,"video"===r?(this.localVideoRef.srcObject=l?c:null,this.remoteVideoRef.srcObject=l||c):(this.localAudioRef.srcObject=c,this.remoteAudioRef.srcObject=l),!a){e.next=7;break}return e.next=5,D.a.fire({title:a.toString(),icon:"error",showCloseButton:!0});case 5:e.sent.value&&(n(),o());case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=t.callType,n=t.remoteStream,o=t.localStream,r=null;return r="video"===a?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:_t.a.videoContainer},c.a.createElement("video",{className:_t.a.LocalVideo,autoPlay:!0,muted:!0,ref:function(t){return e.localVideoRef=t}}),c.a.createElement("video",{className:_t.a.RemoteVideo,autoPlay:!0,muted:!n,ref:function(t){return e.remoteVideoRef=t}})),(o||n)&&c.a.createElement("div",{className:_t.a.CallButtons},c.a.createElement("span",{onClick:this.endCall,className:_t.a.EndCallBtn},pe("endCall","white","50","50")),c.a.createElement("span",{onClick:this.endCall,className:_t.a.MuteBtn},pe("microphone","white","50","50")))):c.a.createElement(c.a.Fragment,null,c.a.createElement("audio",{autoPlay:!0,src:this.props.localStream,muted:!0,ref:function(t){return e.localAudioRef=t}}),c.a.createElement("audio",{autoPlay:!0,src:this.props.remoteStream,ref:function(t){return e.remoteAudioRef=t}})),c.a.createElement("div",{className:_t.a.Call},r)}}]),t}(r.Component),Et=Object(v.b)(function(e){return{userId:e.auth.userId,channel:e.call.channel,remoteStream:e.call.remoteStream,localStream:e.call.localStream,incomingCall:e.call.incomingCall,caller:e.call.caller,error:e.call.error}},function(e){return{callUser:function(t,a){return e(function(e,t){return n=e,F.type=t,console.log("calling "+e+"...."),function(e){(o=new RTCPeerConnection(V)).ontrack=function(e){Wt.dispatch(K(e))},o.onicecandidate=function(e){e.candidate&&q({type:"candidate",candidate:e.candidate})},W().then(Y).catch(function(t){e(X(t)),console.log("getUserMedia() error: ".concat(t))})}}(t,a))},endCall:function(){return e(function(e){console.log(n),q({type:"leave",name:n}),$()})}}})(vt),Ct=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={showModal:!1,isVideo:!1,callType:"",showOptions:!1,position:{}},a.onVideoCallInit=function(){a.setState({showModal:!0,callType:"video",isVideo:!0})},a.onVoiceCallInit=function(){a.setState({showModal:!0,isVideo:!1,callType:"audio"})},a.showOptions=function(e){var t=Object(N.a)({},a.state.position);t.x=e.clientX,t.y=e.clientY,a.setState({showOptions:!0,position:t})},a.hideOptions=function(){a.setState({showOptions:!1,position:{}})},a.endCall=function(){a.setState({showModal:!1})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=null;return this.state.showOptions&&(e=c.a.createElement(Fe,{hideOptions:this.hideOptions,position:this.state.position,show:this.state.showOptions,options:[{name:"Contact info"},{name:"Select messages"},{name:"Mute"},{name:"Clear messages"},{name:"Delete chat"}]})),c.a.createElement("div",{className:st.a.ChatScreenBar},c.a.createElement("div",{className:st.a.FloatedRight},c.a.createElement("img",{src:this.props.room.customData.displayImage,alt:""}),c.a.createElement("span",{className:st.a.RoomDetails},c.a.createElement("span",{className:st.a.RoomName},this.props.room.name),!this.props.room.isPrivate&&c.a.createElement("span",{className:st.a.RoomMembers},"Ahmed, Aunty Hauwa, Aunty Lami, Hajju"))),c.a.createElement("div",{className:st.a.FA},this.props.room.isPrivate&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{onClick:this.onVideoCallInit},pe("video","#263238","28","24")),c.a.createElement("span",{onClick:this.onVoiceCallInit},pe("voice","#263238","24","24"))),c.a.createElement("span",{onClick:this.showOptions},pe("ellipsis","#263238","24","24")),e),c.a.createElement(pt,{show:this.state.showModal},this.state.callType?c.a.createElement(Et,{callTo:this.props.room.name,closeModal:this.endCall,callType:this.state.callType}):null))}}]),t}(r.Component),bt=Object(v.b)(function(e){return{callEnded:e.call.callEnded,callStarted:e.call.callOngoing}})(Ct),Ot=a(86),wt=a.n(Ot),St=function(e){return c.a.createElement("div",{className:wt.a.Spinner})},Nt=a(30),yt=a.n(Nt),It=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={showSubmitButton:!1,showBackBtn:!1,searchText:""},a.labelClickedHandler=function(){return a.setState({showBackBtn:!0})},a.onChange=function(e){return a.setState({searchText:e.target.value})},a.onSubmit=function(){var e={chatParticipant:a.state.searchText};a.props.onStartNewChat(e)},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.searchText,a=e.showBackBtn;return c.a.createElement("div",{className:yt.a.Search},c.a.createElement("label",{className:yt.a.SearchLabel,onClick:this.labelClickedHandler},c.a.createElement("span",{className:yt.a.SearchBtn},c.a.createElement("i",{className:"fa fa-search"})),c.a.createElement("input",{value:t,type:"text",onChange:this.onChange,placeholder:"Search contacts"})),a&&c.a.createElement("span",{className:yt.a.BackBtn},c.a.createElement("i",{className:"fa fa-arrow-left"})),t.length>2&&c.a.createElement("span",{className:yt.a.SubmitBtn,onClick:this.onSubmit},c.a.createElement("i",{className:"fa fa-check"})))}}]),t}(r.Component),jt=Object(v.b)(null,function(e){return{onStartNewChat:function(t){return e(ce(t))}}})(It),kt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={text:"",showProfile:!1,contacts:[],position:{},showOptions:!1},a.scrollToBottom=function(){if(a.scrollRef&&a.props.messages.length>0){var e=a.scrollRef.children[a.scrollRef.children.length-1];e.scrollIntoView(),console.log(e)}},a.getMessages=function(e){a.props.getMessages(e),a.scrollToBottom()},a.onChange=function(e){a.setState({text:e.target.value})},a.onSubmit=function(e){e.preventDefault();var t={text:a.state.text,roomId:a.props.currentRoom.id};a.props.sendMessage(t),a.setState({text:""})},a.toggleProfile=function(){a.setState(function(e){return{showProfile:!e.showProfile}})},a.showOptions=function(e){var t=Object(N.a)({},a.state.position);t.x=e.clientX,t.y=e.clientY,a.setState({showOptions:!0,position:t})},a.hideOptions=function(){a.setState({showOptions:!1,position:{}})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.chatInit(),this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=c.a.createElement(pt,{show:!0},c.a.createElement(St,null));t=this.props.currentRoom?c.a.createElement("div",{className:ot.a.Chat},c.a.createElement("div",{className:ot.a.BackgroundImage}),c.a.createElement(bt,{room:this.props.currentRoom,endCall:this.props.endCall}),c.a.createElement("div",{className:ot.a.Msgs,ref:function(t){e.scrollRef=t}},this.props.messages.map(function(t){return c.a.createElement(at,{sender:t.senderId,byCurrentUser:e.props.userId===t.senderId,text:t.text,key:t.id})})),c.a.createElement("form",{onSubmit:this.onSubmit},c.a.createElement("input",{onChange:this.onChange,value:this.state.text,name:"text",type:"text",placeholder:"Enter message"}))):c.a.createElement("div",{className:ot.a.Chat});var a=null;this.state.showOptions&&(a=c.a.createElement(Fe,{hideOptions:this.hideOptions,position:this.state.position,show:this.state.showOptions,showProfile:this.toggleProfile,options:[{name:"New group"},{name:"Profile"},{name:"Log out"}]}));var n=c.a.createElement(pt,{show:!0},c.a.createElement(St,null));return this.props.chatkitUser&&(n=c.a.createElement("div",{className:ot.a.ContactsPane},c.a.createElement(lt,{show:this.state.showProfile,hideProfile:this.toggleProfile,user:this.props.chatkitUser}),c.a.createElement("div",{className:ot.a.MenuBar},c.a.createElement("span",{onClick:this.toggleProfile,className:ot.a.MenuImageContainer},c.a.createElement("img",{src:Be.a,alt:""})),c.a.createElement("span",{onClick:this.showOptions},c.a.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},c.a.createElement("path",{fill:"#263238",fillOpacity:".6",d:"M12 7a2 2 0 1 0-.001-4.001A2 2 0 0 0 12 7zm0 2a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 9zm0 6a2 2 0 1 0-.001 3.999A2 2 0 0 0 12 15z"}))),a),c.a.createElement(jt,null),this.props.contacts.length?this.props.contacts.map(function(t){return c.a.createElement(Ge,{key:t.id,name:t.name,room:t,user:e.props.userId,unopenedMessages:e.props.unopenedMessages,Active:!!e.props.currentRoom&&t.id===e.props.currentRoom.id,clicked:function(){return e.getMessages(t)}})}):c.a.createElement($e,null))),c.a.createElement("div",{className:ot.a.ChatScreen},n,t)}}]),t}(r.Component),Tt=Object(v.b)(function(e){return{userId:e.auth.userId,channel:e.call.channel,chatkitUser:e.chat.currentUser,currentRoom:e.chat.currentRoom,messages:e.chat.messages,endCall:e.call.endCall,unopenedMessages:e.chat.unopenedMessages,contacts:e.chat.contacts}},function(e){return{chatInit:function(){return e(function(e,t){var a=t().auth.userId;new te.ChatManager({instanceLocator:"v1:us1:64b7dbdb-3e59-4fad-9823-83add90cba65",userId:a,tokenProvider:new te.TokenProvider({url:"https://us1.pusherplatform.io/services/chatkit_token_provider/v1/64b7dbdb-3e59-4fad-9823-83add90cba65/token"})}).connect({onAddedToRoom:function(e){ae(),re(e)}}).then(function(t){e(oe(ee=t)),e(ne(ee)),e(ae())}).catch(function(e){return console.log(e)})})},getMessages:function(t){return e(re(t))},sendMessage:function(t){return e(function(e){return function(t){ee.sendMessage(e)}}(t))}}})(kt),Rt=(a(173),a(87)),Lt=a.n(Rt),Pt=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={showCallNotification:!1},a.acceptCall=function(){a.ringtoneRef.pause(),a.ringtoneRef.currentTime=0,a.props.callAccepted()},a.rejectCall=function(){a.ringtoneRef.pause(),a.ringtoneRef.currentTime=0,a.props.callRejected()},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.onAuth(),this.props.isLoggedIn||this.props.history.push("/login")}},{key:"componentDidUpdate",value:function(){this.props.isLoggedIn&&(this.props.channel||this.props.getCallerReady())}},{key:"render",value:function(){var e=this,t=null;return this.props.isLoggedIn&&(this.props.incomingCall?(this.ringtoneRef.play(),t=c.a.createElement(S,{acceptCall:this.acceptCall,rejectCall:this.rejectCall,caller:this.props.caller,callType:this.props.callType})):t=this.props.callOngoing?c.a.createElement(c.a.Fragment,null,c.a.createElement(pt,{show:!0},c.a.createElement(Et,{role:"callee",callType:this.props.callType})),c.a.createElement(Tt,null)):c.a.createElement(Tt,null)),c.a.createElement("div",null,c.a.createElement(ke,null),c.a.createElement("div",{className:"container"},t,c.a.createElement("audio",{src:Lt.a,loop:!0,ref:function(t){return e.ringtoneRef=t}}),c.a.createElement(h.a,null,c.a.createElement(f.a,{path:"/register",component:_e}),c.a.createElement(f.a,{path:"/login",component:Oe}),c.a.createElement(f.a,{path:"/logout",component:Se}),!this.props.isLoggedIn&&c.a.createElement(g.a,{to:"/login"}))))}}]),t}(r.Component),xt=Object(_.a)(Object(v.b)(function(e){return{isLoggedIn:null!==e.auth.token,incomingCall:e.call.incomingCall,callType:e.call.callType,channel:e.call.channel,caller:e.call.caller,callOngoing:e.call.callOngoing}},function(e){return{onAuth:function(){return e(function(e){var t=localStorage.getItem("token");if(t){var a=new Date(localStorage.getItem("expiresIn"));if(a<=new Date)e(P);else{var n=localStorage.getItem("userId");e(x(t,n)),e(R((a.getTime()-(new Date).getTime())/1e3))}}else e(P())})},getCallerReady:function(){return e(function(e){q({type:"login",name:U}),e({type:"PREPARE_CALLER",channel:G})})},callAccepted:function(){return e(function(e){q({type:"answerToRequest",to:n,from:U}),e({type:"CALL_ACCEPTED"})})},callRejected:function(){return e(function(e){e({type:"CALL_REJECTED"})})}}})(Pt)),At=a(181),Bt=a(21),Mt=a(88);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Dt={token:null,userId:null,registrationSuccess:!1,error:null},Ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ON_AUTH_INIT":return Object(N.a)({},e,{error:null});case"LOG_IN":return Object(N.a)({},e,{token:t.token,userId:t.userId,error:null});case"LOG_OUT":return Object(N.a)({},e,{token:null,userId:null});case"ON_AUTH":return Object(N.a)({},e,{token:t.token,userId:t.userId});case"ON_REGISTER":return Object(N.a)({},e,{registrationSuccess:!0});case"LOG_IN_FAILED":case"ON_REGISTRATION_FAILED":return Object(N.a)({},e,{error:t.error});default:return e}},Ft={channel:null,remoteStream:null,localStream:null,incomingCall:!1,callType:null,caller:null,callOngoing:!1,callStarted:!1,callEnded:!1,error:null},Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PREPARE_CALLER":return Object(N.a)({},e,{channel:t.channel});case"CALL_INIT":return Object(N.a)({},e,{callStarted:!0,callEnded:!1});case"ON_TRACK":return Object(N.a)({},e,{remoteStream:t.remoteStream});case"ON_LOCAL_STREAM":return Object(N.a)({},e,{localStream:t.stream});case"ON_INCOMING_CALL":return Object(N.a)({},e,{incomingCall:!0,callType:t.callType,caller:t.caller});case"CALL_ACCEPTED":return Object(N.a)({},e,{incomingCall:!1,callOngoing:!0});case"CALL_REJECTED":return Object(N.a)({},e,{incomingCall:!1,callOngoing:!1});case"END_CALL":return Object(N.a)({},e,{callOngoing:!1,incomingCall:!1,callEnded:!0,callStarted:!1,error:null});case"ON_ERROR":return Object(N.a)({},e,{error:t.error});default:return e}},Vt=a(89),Jt={currentUser:null,contacts:[],currentRoom:null,messages:[],unopenedMessages:{}},Ht=function(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"CHAT_INIT_SUCCESS":return Object(N.a)({},a,{currentUser:n.currentUser});case"FETCH_MESSAGES_SUCCESS":return Object(N.a)({},a,{messages:n.messages,currentRoom:n.room,unopenedMessages:(e=a.unopenedMessages,t=n.room.id,Object.keys(e).reduce(function(a,n){return n!==t?Object(N.a)({},a,Object(y.a)({},n,e[n])):a},{}))});case"ON_NEW_MESSAGE":if(n.belongsToCurrentRoom)return Object(N.a)({},a,{messages:[].concat(Object(Vt.a)(a.messages),[n.message])});var o=Object(N.a)({},a.unopenedMessages);return o.hasOwnProperty(n.message.roomId)?o[n.message.roomId].push(n.message):o[n.message.roomId]=[n.message],Object(N.a)({},a,{unopenedMessages:o});case"ON_ROOMS_FETCHED":return Object(N.a)({},a,{contacts:n.contacts});case"SUBSCRIPTIONSUCCESSFUL":return Object(N.a)({},a,{contacts:n.rooms});default:return a}};a.d(t,"store",function(){return Wt});var zt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Bt.d,qt=Object(Bt.c)({auth:Ut,call:Gt,chat:Ht}),Wt=Object(Bt.e)(qt,zt(Object(Bt.a)(Mt.a)));i.a.render(c.a.createElement(v.a,{store:Wt},c.a.createElement(At.a,null,c.a.createElement(xt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},18:function(e,t,a){e.exports={Navbar:"Navbar_Navbar__aDuUt",FloatedRight:"Navbar_FloatedRight__37wdx",NavItem:"Navbar_NavItem__1tVnh",Brand:"Navbar_Brand__2R68w"}},19:function(e,t,a){e.exports={Call:"Call_Call__3pF_p",videoContainer:"Call_videoContainer__pOd87",RemoteVideo:"Call_RemoteVideo__6iJ4d",LocalVideo:"Call_LocalVideo__277KJ",CallButtons:"Call_CallButtons__3GI_O",EndCallBtn:"Call_EndCallBtn__EVTd_",MuteBtn:"Call_MuteBtn__25o6i"}},22:function(e,t,a){e.exports={NoContacts:"NoContacts_NoContacts__1427s",UserActions:"NoContacts_UserActions__2KqL3",UserAction:"NoContacts_UserAction__3FYgE",ActionsIcons:"NoContacts_ActionsIcons__1QHcE"}},23:function(e,t,a){e.exports={ChatScreenBar:"ChatScreenBar_ChatScreenBar__3nwU6",FloatedRight:"ChatScreenBar_FloatedRight__3Wfev",RoomDetails:"ChatScreenBar_RoomDetails__5Xqgs",RoomName:"ChatScreenBar_RoomName__2r4jw",RoomMembers:"ChatScreenBar_RoomMembers__1_yhF",FA:"ChatScreenBar_FA__sok0_"}},26:function(e,t,a){e.exports=a.p+"static/media/p37605.8335e87d.png"},28:function(e,t,a){e.exports={Input:"Input_Input__1qkWX",Label:"Input_Label__22HBZ",InputElement:"Input_InputElement__3x11B",Invalid:"Input_Invalid__2JnXU"}},29:function(e,t,a){e.exports={Login:"Login_Login__2hIs6",AuthOptions:"Login_AuthOptions__R7y7_",LoginOptions:"Login_LoginOptions__1HYKs",LoginOptionsIcons:"Login_LoginOptionsIcons__9erOn",LoadingText:"Login_LoadingText__3lTuR"}},30:function(e,t,a){e.exports={Search:"Search_Search__1IDVU",SearchLabel:"Search_SearchLabel__gOtCP",SearchBtn:"Search_SearchBtn__3zTPm",BackBtn:"Search_BackBtn__QXY2H",SubmitBtn:"Search_SubmitBtn__K9NOI",spin:"Search_spin__3V4J3"}},32:function(e,t,a){e.exports={SideDrawer:"SideDrawer_SideDrawer__dbIRY",Open:"SideDrawer_Open__2WcxM",Close:"SideDrawer_Close__g0gN6",PP:"SideDrawer_PP__2CF3U",divs:"SideDrawer_divs__1xfzY",RoomsList:"SideDrawer_RoomsList__2HbRj"}},33:function(e,t,a){e.exports={Chat:"Chat_Chat__3TzaC",ByCurrentUser:"Chat_ByCurrentUser__3isyZ",Sender:"Chat_Sender__1gXJ1",Text:"Chat_Text__VVd_1"}},50:function(e,t,a){e.exports={Button:"Button_Button__2TE34",Success:"Button_Success__2n8wq",Danger:"Button_Danger__2Kz76"}},51:function(e,t,a){e.exports={IncomingCall:"IncomingCall_IncomingCall__1wsfq",Buttons:"IncomingCall_Buttons__6-Lpq"}},52:function(e,t,a){e.exports={RegisterBox:"Register_RegisterBox__30el9",LoadingText:"Register_LoadingText__3UQcZ"}},79:function(e,t,a){e.exports={ErrorBox:"ErrorBox_ErrorBox__wKH58"}},80:function(e,t,a){e.exports={OptionsDropbar:"OptionsDropbar_OptionsDropbar__2KLcm"}},82:function(e,t,a){e.exports={JoinableRoom:"JoinableRoom_JoinableRoom__1Zws2"}},83:function(e,t,a){e.exports={TabBar:"TabBar_TabBar__39o86"}},84:function(e,t,a){e.exports={Modal:"Modal_Modal__3o5hh"}},86:function(e,t,a){e.exports={Spinner:"Spinner_Spinner__dxPXP",spin:"Spinner_spin__24L5x"}},87:function(e,t,a){e.exports=a.p+"static/media/iphone_trap_remix.d21333e9.mp3"},90:function(e,t,a){e.exports=a(175)},95:function(e,t,a){}},[[90,2,1]]]);
//# sourceMappingURL=main.d6721bcc.chunk.js.map